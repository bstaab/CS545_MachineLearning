{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Pytorch: nn Module"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The `torch.tensor` is just a small part of `pytorch`.  The main contribution of the `pytorch` package is its `nn` module that is used to construct and train many kinds of neural networks.\n",
    "\n",
    "Here we apply it to the two problems, one regression and one classification problem."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 130,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import pandas\n",
    "import torch\n",
    "\n",
    "import time\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Regression"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Load data for the air quality regression problem. `torch.nn` expects data to be `float32`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 131,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[18. ,  2.6],\n",
       "       [19. ,  2. ],\n",
       "       [20. ,  2.2],\n",
       "       [21. ,  2.2],\n",
       "       [22. ,  1.6],\n",
       "       [23. ,  1.2],\n",
       "       [ 0. ,  1.2],\n",
       "       [ 1. ,  1. ],\n",
       "       [ 2. ,  0.9],\n",
       "       [ 3. ,  0.6]], dtype=float32)"
      ]
     },
     "execution_count": 131,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data = pandas.read_csv('AirQualityUCI.csv', delimiter=';', decimal=',', usecols=range(15), na_values=-200)\n",
    "data = data[['Time', 'CO(GT)']]\n",
    "data = data [:23*10]\n",
    "data = data.dropna(axis=0)\n",
    "\n",
    "hour = [int(t[:2]) for t in data['Time']]\n",
    "X = np.array(hour).reshape(-1, 1).astype(np.float32)\n",
    "CO = data['CO(GT)']\n",
    "T = np.array(CO).reshape(-1, 1).astype(np.float32)\n",
    "np.hstack((X, T))[:10]  # show the first 10 samples of hour, CO"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Since we are using `torch`, we must convert our data matrices, `X` and `T`, to `torch.tensors`."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Must standardize data ourselves."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 132,
   "metadata": {},
   "outputs": [],
   "source": [
    "Xmean = X.mean()\n",
    "Xstd = X.std()\n",
    "Tmean = T.mean()\n",
    "Tstd = T.std()\n",
    "\n",
    "X = (X - Xmean) / Xstd\n",
    "T = (T - Tmean) / Tstd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 133,
   "metadata": {},
   "outputs": [],
   "source": [
    "Xt = torch.tensor(X)\n",
    "Tt = torch.tensor(T)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 134,
   "metadata": {},
   "outputs": [],
   "source": [
    "n_inputs = Xt.shape[1]\n",
    "n_hiddens = 10\n",
    "n_outputs = Tt.shape[1]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Create the network."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 135,
   "metadata": {},
   "outputs": [],
   "source": [
    "nnet = torch.nn.Sequential(\n",
    "    torch.nn.Linear(n_inputs, n_hiddens),\n",
    "    torch.nn.Tanh(),\n",
    "    torch.nn.Linear(n_hiddens, n_outputs))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Specify the loss function and the optimizer method."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 136,
   "metadata": {},
   "outputs": [],
   "source": [
    "loss_F = torch.nn.MSELoss()\n",
    "learning_rate = 0.0001\n",
    "optimizer = torch.optim.Adam(nnet.parameters(), lr=learning_rate)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now we can train it."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 137,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 0 error 1.203939437866211\n",
      "Epoch 1000 error 0.7816133499145508\n",
      "Epoch 2000 error 0.8471205234527588\n",
      "Epoch 3000 error 0.7705135345458984\n",
      "Epoch 4000 error 0.820425808429718\n",
      "Epoch 5000 error 0.7361392378807068\n",
      "Epoch 6000 error 0.7600463628768921\n",
      "Epoch 7000 error 0.7216783165931702\n",
      "Epoch 8000 error 0.7311856150627136\n",
      "Epoch 9000 error 0.7204163074493408\n"
     ]
    }
   ],
   "source": [
    "for epoch in range(10000):\n",
    "    Yt = nnet(Xt)\n",
    "    \n",
    "    error = loss_F(Yt, Tt)\n",
    "    if epoch % 1000 == 0:\n",
    "        print(f'Epoch {epoch} error {error}')\n",
    "        \n",
    "    error.backward()\n",
    "    \n",
    "    optimizer.step()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 138,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "xs = np.linspace(0, 23, 100).reshape((-1, 1)).astype(np.float32)\n",
    "xs = (xs - Xmean) / Xstd\n",
    "xst = torch.tensor(xs)\n",
    "Yt = nnet(xst)\n",
    "plt.plot(Xt, Tt, 'k.', label='T')\n",
    "plt.plot(xs, Yt.detach(), label='Y')\n",
    "plt.legend();"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Here is all the code together in one block. It assumes the data has been defined."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 139,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 0 error 1.0984083414077759\n",
      "Epoch 200 error 0.6792359352111816\n",
      "Epoch 400 error 0.40747976303100586\n",
      "Epoch 600 error 0.374590665102005\n",
      "Epoch 800 error 0.3648611605167389\n",
      "Epoch 1000 error 0.3624788224697113\n",
      "Epoch 1200 error 0.36154624819755554\n",
      "Epoch 1400 error 0.3611183762550354\n",
      "Epoch 1600 error 0.3608730435371399\n",
      "Epoch 1800 error 0.3607073724269867\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "Xt = torch.tensor(X)\n",
    "Tt = torch.tensor(T)\n",
    "\n",
    "Xtmean = Xt.mean()\n",
    "Xtstd = Xt.std()\n",
    "Ttmean = Tt.mean()\n",
    "Ttstd = Tt.std()\n",
    "\n",
    "Xt = (Xt - Xtmean) / Xtstd\n",
    "Tt = (Tt - Ttmean) / Ttstd\n",
    "\n",
    "n_inputs = Xt.shape[1]\n",
    "n_hiddens = 20\n",
    "n_outputs = Tt.shape[1]\n",
    "\n",
    "nnet = torch.nn.Sequential(\n",
    "    torch.nn.Linear(n_inputs, n_hiddens),\n",
    "    torch.nn.Tanh(),\n",
    "    torch.nn.Linear(n_hiddens, n_outputs))\n",
    "\n",
    "loss_F = torch.nn.MSELoss()\n",
    "learning_rate = 0.01\n",
    "optimizer = torch.optim.Adam(nnet.parameters(), lr=learning_rate)\n",
    "\n",
    "for epoch in range(2000):\n",
    "    \n",
    "    optimizer.zero_grad()\n",
    "        \n",
    "    Yt = nnet(Xt)\n",
    "    \n",
    "    error = loss_F(Yt, Tt)\n",
    "    if epoch % 200 == 0:\n",
    "        print(f'Epoch {epoch} error {error}')\n",
    "        \n",
    "    error.backward()\n",
    "    \n",
    "    optimizer.step()\n",
    "\n",
    "xs = np.linspace(0, 23, 100).reshape((-1, 1)).astype(np.float32)\n",
    "xs = (xs - Xmean) / Xstd\n",
    "xst = torch.tensor(xs)\n",
    "Yt = nnet(xst)\n",
    "plt.plot(Xt, Tt, 'k.', label='T')\n",
    "plt.plot(xs, Yt.detach(), label='Y')\n",
    "plt.legend();"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Classification"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let's make some simple images of two different types to test the `torch.nn` module way of doing classification.\n",
    "\n",
    "One type of image with be a diamond shape at various positions.  The other type will be a square."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 140,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "((200, 1, 20, 20), (200, 1), (20, 1, 20, 20), (20, 1))"
      ]
     },
     "execution_count": 140,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "def make_images(nEach):\n",
    "    images = np.zeros((nEach * 2, 1, 20, 20))  # nSamples, nChannels, rows, columns\n",
    "    radii = 3 + np.random.randint(10 - 5, size=(nEach * 2, 1))\n",
    "    centers = np.zeros((nEach * 2, 2))\n",
    "    for i in range(nEach * 2):\n",
    "        r = radii[i, 0]\n",
    "        centers[i, :] = r + 1 + np.random.randint(18 - 2 * r, size=(1, 2))\n",
    "        x = int(centers[i, 0])\n",
    "        y = int(centers[i, 1])\n",
    "        if i < nEach:\n",
    "            # squares\n",
    "            images[i, 0, x - r:x + r, y + r] = 1.0\n",
    "            images[i, 0, x - r:x + r, y - r] = 1.0\n",
    "            images[i, 0, x - r, y - r:y + r] = 1.0\n",
    "            images[i, 0, x + r, y - r:y + r + 1] = 1.0\n",
    "        else:\n",
    "            # diamonds\n",
    "            images[i, 0, range(x - r, x), range(y, y + r)] = 1.0\n",
    "            images[i, 0, range(x - r, x), range(y, y - r, -1)] = 1.0\n",
    "            images[i, 0, range(x, x + r + 1), range(y + r, y - 1, -1)] = 1.0\n",
    "            images[i, 0, range(x, x + r), range(y - r, y)] = 1.0\n",
    "            # images += np.random.randn(*images.shape) * 0.5\n",
    "            T = np.ones((nEach * 2, 1))\n",
    "            T[nEach:] = 2\n",
    "    return images.astype(np.float32), T.astype(np.float32)\n",
    "\n",
    "Xtrain, Ttrain = make_images(100)\n",
    "Xtest, Ttest = make_images(10)\n",
    "Xtrain.shape, Ttrain.shape, Xtest.shape, Ttest.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 141,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[1.],\n",
       "       [1.],\n",
       "       [1.],\n",
       "       [1.],\n",
       "       [1.],\n",
       "       [1.],\n",
       "       [1.],\n",
       "       [1.],\n",
       "       [1.],\n",
       "       [1.],\n",
       "       [2.],\n",
       "       [2.],\n",
       "       [2.],\n",
       "       [2.],\n",
       "       [2.],\n",
       "       [2.],\n",
       "       [2.],\n",
       "       [2.],\n",
       "       [2.],\n",
       "       [2.]], dtype=float32)"
      ]
     },
     "execution_count": 141,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Ttest"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 142,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAA1MAAAD5CAYAAADC12+JAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAMNklEQVR4nO3dP4ttVxkG8LXiFSKkt7O2sLWwUNBCSGFrE7SQfIiYRmxCQAs7Cyu/hUUKQQj4AYRgLNLZSdBouiyL68W5Q87Mmee+e++19vn9YOBeLjPnzHPW+fOw3rVvH2M0AAAAnua1o+8AAADAipQpAACAgDIFAAAQUKYAAAACyhQAAEBAmQIAAAgoUwAAAIHdylTv/bM7X1/03j+/8/e3Cm/nx733D3vv/+m9/7Hq585IptuQaz2Z1pNpPZnWk2k9mdaTab1byvTZXjc0xnjjxZ9775+01t4eY3ywwU39o7X2m9baN1trP9jg509DptuQaz2Z1pNpPZnWk2k9mdaTab1bynS3MrWXFw9U7/3to+/LWch0G3KtJ9N6Mq0n03oyrSfTejKtN0Om056Z6r2/03v/9NLX0fdvRTLdhlzrybSeTOvJtJ5M68m0nkzrrZzptDtTY4z3W2vvH30/zkSm25BrPZnWk2k9mdaTaT2Z1pNpvZUznXZnCgAAYGbTlqne+7v3rgTy0tfR929FMt2GXOvJtJ5M68m0nkzrybSeTOutnOm0ZWqM8d4Y441LX5e+r/f+ld776+35CONrvffXe+9f3e+ez0um25BrPZnWk2k9mdaTaT2Z1pNpvZUznbZMvYKftNY+b639trX23f/9+XeH3qP1yXQbcq0n03oyrSfTejKtJ9N6Mq13eKZ9jLHn7QEAAJzCGXemAAAANqdMAQAABJQpAACAgDIFAAAQUKYAAAACzx75d5f6u6yH3yfTy2RaL820Nbk+xFqtJ9N6Mq0n03oyrSfTehcztTMFAAAQUKYAAAACyhQAAEDgsTNTsJzeX+WY0OPGMFIMAICdKQAAgIgyBQAAEDDmx6lVjeRtPToI1Jv5eWtcmBdmXqcp65tbYmcKAAAgoEwBAAAElCkAAICAM1MA3ISjz3Gc8WwM9Y5ep6mj1/fRt7+FVdfCrbEzBQAAEFCmAAAAAsb8AIBNrTqCZcxqTas+bqs+T26dnSkAAICAMgUAABBQpgAAAALOTJ3QzDO3q84xw0xmfo4/xPOfF2ZeC6s+v4Bj2JkCAAAIKFMAAAABY34nd/QohXGJ27D143z0Op7ZzNl4/gPcnlVf+9P3UztTAAAAAWUKAAAgoEwBAAAEnJni1Fad211Z1Rkejx0ArO0WzvXamQIAAAgoUwAAAAFjfpzOzFvKAACch50pAACAgDIFAAAQUKYAAAACyhQAAEBAmQIAAAgoUwAAAAFlCgAAIKBMAQAABJQpAACAgDIFAAAQUKYAAAACyhQAAEBAmQIAAAgoUwAAAIFn6Tf23ivvx5caY2x+G0CtPV4bIGFtAlDNzhQAAEBAmQIAAAjEY373VYzkGcGANRnJZUbWJQBbszMFAAAQUKYAAAACyhQAAEBAmQIAAAgoUwAAAAFlCgAAIFB2aXTm5HLzAACwDTtTAAAAAWUKAAAgoEwBAAAEnJk6oTHG0XcBAC5ynvcy2cBa7EwBAAAElCkAAICAMT+AhRkJYgXGzy+TTT2vi+zJzhQAAEBAmQIAAAgoUwAAAIGyM1PmUwH24YwFwMu8Ls7pFvqBnSkAAICAMgUAABCIx/xspwIAAHfdWkewMwUAABBQpgAAAALKFAAAQKDf2lwjAABABTtTAAAAAWUKAAAgoEwBAAAElCkAAICAMgUAABBQpgAAAALKFAAAQECZAgAACChTAAAAAWUKAAAgoEwBAAAElCkAAICAMgUAABBQpgAAAALKFAAAQECZAgAACChTAAAAAWUKAAAgoEwBAAAElCkAAICAMgUAABBQpgAAAALKFAAAQECZAgAACChTAAAAAWUKAAAgoEwBAAAElCkAAICAMgUAABBQpgAAAALKFAAAQECZAgAACChTAAAAAWUKAAAgoEwBAAAElCkAAICAMgUAABBQpgAAAALKFAAAQECZAgAACChTAAAAAWUKAAAgoEwBAAAElCkAAICAMgUAABBQpgAAAALKFAAAQECZAgAACChTAAAAAWUKAAAgoEwBAAAElCkAAICAMgUAABBQpgAAAALKFAAAQECZAgAACChTAAAAAWUKAAAgoEwBAAAElCkAAICAMgUAABDYrUz13j+78/VF7/3zO39/q/B2ft17/7j3/q/e+0e9959W/ezZyHQbcq0n03oyrSfTejKtJ9N6Mq13S5k+2+uGxhhvvPhz7/2T1trbY4wPNripf7fWftRa+2tr7duttT/03v82xvhwg9s6lEy3Idd6Mq0n03oyrSfTejKtJ9N6t5Tp6cb8xhi/GGN8NMb4Yozx59ban1pr3zn6fq1MptuQaz2Z1pNpPZnWk2k9mdaTab0ZMp22TPXe3+m9f3rp68qf8bX2vKX+Zdt7uwaZbkOu9WRaT6b1ZFpPpvVkWk+m9VbOtI8x9ry95ze67Xbf3dv5fWvt6621N8cRv+iOZLoNudaTaT2Z1pNpPZnWk2k9mdY7e6a7nZnaW+/9V621b7XWvn/2RboXmW5DrvVkWk+m9WRaT6b1ZFpPpvWOzHTmMb93+8tXAnnp65Hv/WVr7c3W2g/HGP/c5x7PT6bbkGs9mdaTaT2Z1pNpPZnWk2m9lTM93Zhf7/3nrbWftda+N8b4e/XPn5VMtyHXejKtJ9N6Mq0n03oyrSfTemfPdNqdqVfwXmvtG621j+802nePvlOLk+k25FpPpvVkWk+m9WRaT6b1ZFrv8EwP2ZkCAABY3Rl3pgAAADanTAEAAASUKQAAgIAyBQAAEFCmAAAAAs8e+XeX+rush98n08tkWi/NtDW5PsRarSfTejKtJ9N6Mq0n03oXM7UzBQAAEFCmAAAAAsoUAABA4LEzUwBwU3p/eTR+DMcImN/ddWvNwn7sTAEAAASUKQAAgIAxPwBu3kMjUsanmNFD46hGVWE/dqYAAAACyhQAAEBAmQIAAAg4MwXsxhw/s3jKWnQWhVlce37PuT9WtOo6tTMFAAAQUKYAAAACxvxOzkgKR3PJaWZRsd6sYfZU9R5uVHVbMs2c5fL+dqYAAAACyhQAAEBAmQIAAAg4M3VCzqhwJJecZhZ7rClrmC1VvYd776937WetL/v3W1Zxef/HvndvdqYAAAACyhQAAEDAmN8JGKviaC45zYz2WFPW6XW839S49j1c3vXSz1r3v/fWHostLu9//+cenamdKQAAgIAyBQAAEFCmAAAAAs5MLWrrMyqv8nM5P5ecZkUVa8pavJ7/pmNbMt1eVaa39n62x1qcKVM7UwAAAAFlCgAAIGDMbxF7j1Xdv80zbkOTc8lpVveUNWwtXsd/03Esub06n7UyRz+Hj87UzhQAAEBAmQIAAAgoUwAAAIHdz0wdPVe5kqPnaM20cy2XnGZ1Xu8yW/83HbJna0evt1Vfe47O7SF7Z2pnCgAAIKBMAQAABHYZ83PJ2evMvL3rceNaLjnN6qzF6xnxZTUzr7eZ3yNnzu0he2RqZwoAACCgTAEAAASUKQAAgMAmZ6aeMle56iUhq8w0D/sUt/64cT1rBW6D85LMatX1NtP756rPYZdGBwAAmJQyBQAAEFCmAAAAAmVnpipmJ1edx3wVM83DPsUZH5sz/k6zkeu8Vnr9YQ2rvr9xPquuxZk/l8yc6d652ZkCAAAIKFMAAACBsjG/iu2+2bYJ9zbzmOMZH5uHfqcz/r5w12NrfKbXH9ZnDTGLmV/rVv3scXSmR+dmZwoAACCgTAEAAASUKQAAgEDZmam7njI7OdOs6myOPsNzxsfm2t/JOuWMnrKOj379AdjD0a91Z/x8sUemM+VmZwoAACCgTAEAAAQ2GfO77+gt1DPYY+zsjI9N1e9kDbOiLdb//Z9r/QNn4bNWvapMZ87NzhQAAEBAmQIAAAgoUwAAAIFdzkzdNdOM48oqzvDMPH9aZYtZ3TPmxDndwqw6wFaqzkv7DPF/12a60vuOnSkAAICAMgUAABDYfcyPek8Z5bn1reYzbi/DtZ6yxm/9tQLgrvSz1pf9O8+d5X3HzhQAAEBAmQIAAAgoUwAAAAFnpk7I2Z/rnGVWFxJm/AFyPmvVWzU3O1MAAAABZQoAACBgzO/kVt0yPYKsuGXWP0DG6+dtszMFAAAQUKYAAAACyhQAAECgm/MEAAB4OjtTAAAAAWUKAAAgoEwBAAAElCkAAICAMgUAABBQpgAAAAL/BX5P+0j0tYAhAAAAAElFTkSuQmCC\n",
      "text/plain": [
       "<Figure size 1080x360 with 20 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.figure(figsize=(15, 5))\n",
    "for i in range(20):\n",
    "    plt.subplot(2, 10, i + 1)\n",
    "    plt.imshow(Xtest[i, 0, :, :], cmap=plt.cm.binary)\n",
    "    plt.title(f'T = {int(Ttest[i, 0])}')\n",
    "    plt.axis('off');"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "To send these images as input into a neural network, each image must be flattened.  In this case, each image will be 20 x 20 or 400 pixel intensities."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 143,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7ff078638d50>]"
      ]
     },
     "execution_count": 143,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.plot(Xtest[0, 0, :, :].reshape((-1)))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 144,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(200, 400)"
      ]
     },
     "execution_count": 144,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Xtrain_flat = Xtrain.reshape((-1, 400))\n",
    "Xtrain_flat.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 145,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(20, 400)"
      ]
     },
     "execution_count": 145,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Xtest_flat = Xtest.reshape((-1, 400))\n",
    "Xtest_flat.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 146,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([1., 2.], dtype=float32)"
      ]
     },
     "execution_count": 146,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "classes = np.unique(Ttrain)\n",
    "classes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 148,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])"
      ]
     },
     "execution_count": 148,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "_, Ttrain_0 = np.where(Ttrain == classes)\n",
    "_, Ttest_0 = np.where(Ttest == classes)\n",
    "Ttest_0"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 150,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 0 error 0.68625\n",
      "Epoch 50 error 0.00133\n",
      "Epoch 100 error 0.00040\n",
      "Epoch 150 error 0.00025\n",
      "16 out of 20 test samples correctly classified.\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 1080x360 with 20 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "classes = np.unique(Ttrain)\n",
    "_, Ttrain_0 = np.where(Ttrain == classes)\n",
    "_, Ttest_0 = np.where(Ttest == classes)\n",
    "\n",
    "Xtraint = torch.tensor(Xtrain_flat)\n",
    "Ttraint = torch.tensor(Ttrain_0)\n",
    "Xtestt = torch.tensor(Xtest_flat)\n",
    "Ttestt = torch.tensor(Ttest_0)\n",
    "\n",
    "Xtmean = Xt.mean()\n",
    "Xtstd = Xt.std()\n",
    "\n",
    "if False:\n",
    "    Xtraint = (Xtraint - Xtmean) / Xtstd\n",
    "    Xtestt = (Xtestt - Xtmean) / Xtstd\n",
    "\n",
    "n_inputs = Xtraint.shape[1]\n",
    "n_hiddens = 20\n",
    "n_outputs = len(classes)\n",
    "\n",
    "nnet = torch.nn.Sequential(\n",
    "    torch.nn.Linear(n_inputs, n_hiddens),\n",
    "    torch.nn.Tanh(),\n",
    "    torch.nn.Linear(n_hiddens, n_outputs))\n",
    "\n",
    "loss_F = torch.nn.CrossEntropyLoss()\n",
    "\n",
    "learning_rate = 0.01\n",
    "optimizer = torch.optim.Adam(nnet.parameters(), lr=learning_rate)\n",
    "\n",
    "for epoch in range(200):\n",
    "    \n",
    "    optimizer.zero_grad()\n",
    "    \n",
    "    Ytraint = nnet(Xtraint)\n",
    "    \n",
    "    error = loss_F(Ytraint, Ttraint)\n",
    "    if epoch % 50 == 0:\n",
    "        print(f'Epoch {epoch} error {error:.5f}')\n",
    "        \n",
    "    error.backward()\n",
    "    \n",
    "    optimizer.step()\n",
    "\n",
    "Ytestt = nnet(Xtestt)\n",
    "Ytest = Ytestt.detach().numpy()\n",
    "Ytestclasses = classes[Ytest.argmax(axis=1)].reshape((-1, 1))\n",
    "plt.figure(figsize=(15, 5))\n",
    "for i in range(20):\n",
    "    plt.subplot(2, 10, i + 1)\n",
    "    plt.imshow(Xtest[i, 0, :, :], cmap=plt.cm.binary)\n",
    "    plt.title(f'T = {int(Ttest[i, 0])}\\nY = {int(Ytestclasses[i])}')\n",
    "    plt.axis('off')\n",
    "    \n",
    "print(f'{np.sum(Ttest == Ytestclasses)} out of {Ttest.shape[0]} test samples correctly classified.')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "8062"
      ]
     },
     "execution_count": 64,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "def number_of_weights(torch_nnet):\n",
    "    return sum([p.nelement() for p in torch_nnet.parameters()])\n",
    "\n",
    "number_of_weights(nnet)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Hard to predict correct class on test data.  The particular sizes and locations of objects in test images may not have been seen in training data.  Need a way to discover small features, like vertical, horizontal, diagonal lines, that would help predict correct class.\n",
    "\n",
    "This is exactly what convolutional units are designed for!"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Classification with Convolutional Nets"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "torch.Size([200, 400])"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Xtraint.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 126,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 0 error 0.69900\n",
      "Epoch 50 error 0.64814\n",
      "Epoch 100 error 0.53142\n",
      "Epoch 150 error 0.39575\n",
      "Epoch 200 error 0.27845\n",
      "Epoch 250 error 0.20102\n",
      "Epoch 300 error 0.14569\n",
      "Epoch 350 error 0.10820\n",
      "20 out of 20 test samples correctly classified.\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 1080x360 with 20 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "classes = np.unique(Ttrain)\n",
    "_, Ttrain_0 = np.where(Ttrain == classes)\n",
    "_, Ttest_0 = np.where(Ttest == classes)\n",
    "\n",
    "Xtraint = torch.tensor(Xtrain)\n",
    "Ttraint = torch.tensor(Ttrain_0)\n",
    "Xtestt = torch.tensor(Xtest)\n",
    "Ttestt = torch.tensor(Ttest_0)\n",
    "\n",
    "Xtmean = Xt.mean()\n",
    "Xtstd = Xt.std()\n",
    "\n",
    "# Xtraint = (Xtraint - Xtmean) / Xtstd\n",
    "# Xtestt = (Xtestt - Xtmean) / Xtstd\n",
    "Xtraint = Xtraint\n",
    "Xtestt = Xtestt\n",
    "\n",
    "n_channels = Xtraint.shape[1]\n",
    "n_outputs = len(classes)\n",
    "\n",
    "nnet = torch.nn.Sequential()\n",
    "\n",
    "n_units = 1\n",
    "kernel_size = 5\n",
    "kernel_stride = 2\n",
    "nnet.add_module('conv_1', torch.nn.Conv2d(n_channels, n_units, kernel_size, kernel_stride))\n",
    "nnet.add_module('relu_1', torch.nn.ReLU())\n",
    "n_windows = (Xtraint.shape[2] - kernel_size) // kernel_stride + 1\n",
    "\n",
    "if False:\n",
    "    n_units_previous = n_units\n",
    "    n_units = 3\n",
    "    kernel_size = 3\n",
    "    kernel_stride = 1\n",
    "    nnet.add_module('conv_2', torch.nn.Conv2d(n_units_previous, n_units, kernel_size, kernel_stride))\n",
    "    nnet.add_module('relu_2', torch.nn.ReLU())\n",
    "    n_windows = (n_windows - kernel_size) // kernel_stride + 1\n",
    "\n",
    "nnet.add_module('flatten', torch.nn.Flatten())\n",
    "n_units_previous = n_units\n",
    "n_units = 3\n",
    "n_inputs = n_units_previous * n_windows ** 2\n",
    "nnet.add_module('linear_1', torch.nn.Linear(n_inputs, n_units))\n",
    "nnet.add_module('tanh', torch.nn.Tanh())\n",
    "\n",
    "nnet.add_module('linear 2', torch.nn.Linear(n_units, n_outputs))\n",
    "\n",
    "\n",
    "loss_F = torch.nn.CrossEntropyLoss()\n",
    "\n",
    "learning_rate = 0.001\n",
    "optimizer = torch.optim.Adam(nnet.parameters(), lr=learning_rate)\n",
    "\n",
    "for epoch in range(400):\n",
    "    \n",
    "    optimizer.zero_grad()\n",
    "    \n",
    "    Ytraint = nnet(Xtraint)\n",
    "    \n",
    "    error = loss_F(Ytraint, Ttraint)\n",
    "    if epoch % 50 == 0:\n",
    "        print(f'Epoch {epoch} error {error:.5f}')\n",
    "        \n",
    "    error.backward()\n",
    "    \n",
    "    optimizer.step()\n",
    "\n",
    "Ytestt = nnet(Xtestt)\n",
    "Ytest = Ytestt.detach().numpy()\n",
    "Ytestclasses = classes[Ytest.argmax(axis=1)].reshape((-1, 1))\n",
    "plt.figure(figsize=(15, 5))\n",
    "for i in range(20):\n",
    "    plt.subplot(2, 10, i + 1)\n",
    "    plt.imshow(Xtest[i, 0, :, :], cmap=plt.cm.binary)\n",
    "    plt.title(f'T = {int(Ttest[i, 0])}\\nY = {int(Ytestclasses[i])}')\n",
    "    plt.axis('off')\n",
    "    \n",
    "print(f'{np.sum(Ttest == Ytestclasses)} out of {Ttest.shape[0]} test samples correctly classified.')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 127,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "229"
      ]
     },
     "execution_count": 127,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "number_of_weights(nnet)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 128,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Parameter containing:\n",
       "tensor([[[[ 0.1634,  0.2740,  0.0888, -0.0142,  0.3295],\n",
       "          [-0.0049,  0.1549,  0.0892, -0.0664,  0.3510],\n",
       "          [-0.1548,  0.0333, -0.3949, -0.3847,  0.1035],\n",
       "          [-0.0548,  0.4734,  0.0348,  0.1577,  0.3665],\n",
       "          [-0.0338,  0.2744, -0.2242, -0.3371,  0.1054]]]], requires_grad=True)"
      ]
     },
     "execution_count": 128,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nnet.conv_1.weight"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 129,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAOcAAADnCAYAAADl9EEgAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAADiUlEQVR4nO3YsU0jURhG0WVtk9ECASIipAC6IYMi7FpcAjUgkThzjEQFdDDbgGV5ZOR3F50Tzku+5OqX5mqapj9Az9/RA4DDxAlR4oQocUKUOCFqeexxu93+N79y7+7uRk+Y5ePjY/SEWb6+vkZPONnz8/PoCbM8PDxcHfruckKUOCFKnBAlTogSJ0SJE6LECVHihChxQpQ4IUqcECVOiBInRIkTosQJUeKEKHFClDghSpwQJU6IEidEiROixAlR4oQocUKUOCFKnBAlTogSJ0SJE6LECVHihChxQpQ4IUqcECVOiBInRIkTosQJUeKEKHFClDghSpwQtTz2uNvtLrXjbNM0jZ7wq31/f4+ecLLr6+vRE36EywlR4oQocUKUOCFKnBAlTogSJ0SJE6LECVHihChxQpQ4IUqcECVOiBInRIkTosQJUeKEKHFClDghSpwQJU6IEidEiROixAlR4oQocUKUOCFKnBAlTogSJ0SJE6LECVHihChxQpQ4IUqcECVOiBInRIkTosQJUeKEqOWxx/1+f6kdZ7u5uRk9YZbNZjN6wiyLxWL0hJM9Pj6OnjDL6+vrwe8uJ0SJE6LECVHihChxQpQ4IUqcECVOiBInRIkTosQJUeKEKHFClDghSpwQJU6IEidEiROixAlR4oQocUKUOCFKnBAlTogSJ0SJE6LECVHihChxQpQ4IUqcECVOiBInRIkTosQJUeKEKHFClDghSpwQJU6IEidEiROixAlRy2OPt7e3l9pxtvV6PXrCr3Z/fz96wsmenp5GT/gRLidEiROixAlR4oQocUKUOCFKnBAlTogSJ0SJE6LECVHihChxQpQ4IUqcECVOiBInRIkTosQJUeKEKHFClDghSpwQJU6IEidEiROixAlR4oQocUKUOCFKnBAlTogSJ0SJE6LECVHihChxQpQ4IUqcECVOiBInRIkTopbHHler1aV2nO39/X30hFne3t5GT5jl8/Nz9ISTbTab0RNmeXl5Ofjd5YQocUKUOCFKnBAlTogSJ0SJE6LECVHihChxQpQ4IUqcECVOiBInRIkTosQJUeKEKHFClDghSpwQJU6IEidEiROixAlR4oQocUKUOCFKnBAlTogSJ0SJE6LECVHihChxQpQ4IUqcECVOiBInRIkTosQJUeKEKHFClDgh6mqaptEbgANcTogSJ0SJE6LECVHihChxQtQ/Ik0tE86w4zoAAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "w = nnet.conv_1.weight.detach()\n",
    "for uniti in range(w.shape[0]):\n",
    "    plt.subplot(1, w.shape[0], uniti + 1)\n",
    "    plt.imshow(w[uniti, 0, :, :], cmap=plt.cm.gray)\n",
    "    plt.axis('off')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
